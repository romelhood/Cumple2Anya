<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cumple 2 de Anya Sof√≠a üß∏</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,650;9..144,750&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#FFFDF9;
      --ink:#1E1916;
      --muted:#6E625B;

      --gold:#C9A35E;
      --gold2:#E7D3A8;

      --rose:#F3C2CC;
      --mint:#CFECE2;
      --sky:#D3E3FF;

      --wa1:#25D366;
      --wa2:rgba(37,211,102,.75);

      --serif:"Fraunces", ui-serif, Georgia, serif;
      --sans:"Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background: var(--bg);
      overflow-x:hidden;
    }

    /* Minimal background: soft gradients + subtle star pattern */
    .bg{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:-1;
      background:
        radial-gradient(900px 520px at 15% 10%, rgba(243,194,204,.40), transparent 62%),
        radial-gradient(900px 520px at 88% 14%, rgba(211,227,255,.40), transparent 62%),
        radial-gradient(1100px 640px at 50% 92%, rgba(207,236,226,.42), transparent 62%),
        linear-gradient(180deg, #FFFDF9, #FFFFFF);
    }

    /* star sprinkle using inline SVG as background-image */
    .stars{
      position:fixed;
      inset:-40px;
      pointer-events:none;
      z-index:-1;
      opacity:.55;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='260' height='260' viewBox='0 0 260 260'%3E%3Crect width='260' height='260' fill='transparent'/%3E%3Cg fill='none' stroke='%23C9A35E' stroke-width='2' stroke-linejoin='round' opacity='0.65'%3E%3Cpath d='M40 42l6 12 13 2-9 9 2 13-12-6-12 6 2-13-9-9 13-2z'/%3E%3Cpath d='M210 70l5 10 11 2-8 8 2 11-10-5-10 5 2-11-8-8 11-2z' opacity='0.55'/%3E%3Cpath d='M80 200l5 10 11 2-8 8 2 11-10-5-10 5 2-11-8-8 11-2z' opacity='0.45'/%3E%3Cpath d='M205 205l6 12 13 2-9 9 2 13-12-6-12 6 2-13-9-9 13-2z' opacity='0.35'/%3E%3C/g%3E%3C/svg%3E");
      background-size: 260px 260px;
      background-repeat: repeat;
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 26px 18px 40px;
      position:relative;
    }

    /* Teddy illustration (ÂéüÂàõ SVG, no copyright issues) */
    .teddyCorner{
      position:absolute;
      right: -10px;
      top: 10px;
      width: min(240px, 40vw);
      opacity: .85;
      filter: drop-shadow(0 18px 22px rgba(30,25,22,.08));
      pointer-events:none;
    }
    @media (max-width: 520px){
      .teddyCorner{ right:-30px; top: 6px; width: min(220px, 52vw); opacity:.8; }
    }

    header{
      padding-top: 10px;
      padding-right: 200px; /* room for teddy */
    }
    @media (max-width: 520px){
      header{ padding-right: 120px; }
    }

    .kicker{
      display:inline-flex;
      align-items:center;
      gap:10px;
      font-weight:700;
      color: var(--muted);
      letter-spacing:.02em;
      text-transform: uppercase;
      font-size: .78rem;
    }
    .kDot{
      width:10px;height:10px;border-radius:999px;
      background: var(--rose);
      box-shadow: 0 0 0 6px rgba(243,194,204,.22);
    }

    h1{
      font-family: var(--serif);
      font-size: clamp(2.2rem, 5vw, 3.35rem);
      line-height: 1.02;
      margin: 14px 0 10px;
      letter-spacing:-.02em;
    }

    .sub{
      margin:0;
      color: var(--muted);
      font-size: 1.07rem;
      line-height: 1.55;
      max-width: 62ch;
    }

    .metaLine{
      margin-top: 14px;
      display:flex;
      flex-wrap:wrap;
      gap:12px 18px;
      align-items:center;
      color: var(--muted);
      font-weight:700;
    }
    .metaLine span{
      display:inline-flex;
      gap:10px;
      align-items:center;
    }
    .metaLine b{ color: var(--ink); }

    .divider{
      height:1px;
      background: rgba(30,25,22,.12);
      margin: 22px 0 18px;
    }

    /* Minimal sections (no cards) */
    .sections{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 22px;
      margin-top: 10px;
    }
    @media (max-width: 860px){
      .sections{ grid-template-columns: 1fr; }
    }

    .secTitle{
      font-family: var(--serif);
      font-size: 1.38rem;
      margin: 0 0 10px;
      letter-spacing:-.01em;
    }

    .list{
      display:grid;
      gap: 10px;
      margin-top: 8px;
      color: var(--muted);
      font-weight:600;
      line-height:1.45;
    }

    .li{
      display:flex;
      gap: 12px;
      align-items:flex-start;
    }
    .ico{
      width: 28px;
      height: 28px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      background: rgba(231,211,168,.35);
      border: 1px solid rgba(201,163,94,.20);
      color: rgba(30,25,22,.80);
      font-size: 15px;
    }

    .mapInline{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top: 10px;
      text-decoration:none;
      font-weight:800;
      color: rgba(30,25,22,.82);
      border-bottom: 2px solid rgba(201,163,94,.35);
      padding-bottom: 3px;
      width: fit-content;
      transition: transform .16s ease, border-color .16s ease;
    }
    .mapInline:hover{
      transform: translateY(-1px);
      border-color: rgba(201,163,94,.70);
    }

    .note{
      margin-top: 12px;
      color: rgba(30,25,22,.78);
      font-weight:800;
      background: rgba(207,236,226,.35);
      display:inline-block;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px dashed rgba(30,25,22,.14);
    }

    /* CTA */
    .cta{
      margin-top: 10px;
      color: var(--muted);
      font-weight:650;
      line-height:1.55;
    }

    .btn{
      margin-top: 12px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 14px 18px;
      border-radius: 999px;
      border:none;
      cursor:pointer;
      text-decoration:none;
      font-weight:900;
      font-size: 1rem;
      background: linear-gradient(135deg, var(--wa1), var(--wa2));
      color: #0B2B14;
      box-shadow: 0 14px 36px rgba(20,16,13,.14);
      position:relative;
      overflow:hidden;
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .btn::after{
      content:"";
      position:absolute;
      inset:0;
      transform: translateX(-120%) skewX(-20deg);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.55), transparent);
      transition: transform .75s ease;
      pointer-events:none;
    }
    .btn:hover{ transform: translateY(-2px); box-shadow: 0 20px 44px rgba(20,16,13,.18); }
    .btn:hover::after{ transform: translateX(120%) skewX(-20deg); }
    .btn:active{ transform: translateY(0px) scale(.99); }

    /* Game: minimal (no big frames) */
    .game{
      margin-top: 26px;
      padding-top: 14px;
    }

    .gameHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin-bottom: 10px;
    }

    .hud{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      color: var(--muted);
      font-weight:800;
      font-size: .95rem;
    }
    .hud b{ color: var(--ink); }

    .canvasWrap{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      background: transparent;
    }

    canvas{
      width:100%;
      height:auto;
      display:block;
      border-radius: 18px;
      /* subtle "nothing" border */
      outline: 1px solid rgba(30,25,22,.10);
      background:
        radial-gradient(900px 520px at 15% 10%, rgba(243,194,204,.22), transparent 62%),
        radial-gradient(900px 520px at 88% 14%, rgba(211,227,255,.22), transparent 62%),
        radial-gradient(900px 640px at 50% 95%, rgba(207,236,226,.22), transparent 62%),
        rgba(255,255,255,.55);
      box-shadow: 0 18px 50px rgba(20,16,13,.10);
    }

    .gameActions{
      margin-top: 10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }

    .btn2{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 12px 14px;
      border-radius: 999px;
      border: 1px solid rgba(30,25,22,.12);
      background: rgba(255,255,255,.70);
      color: rgba(30,25,22,.85);
      font-weight:900;
      cursor:pointer;
      transition: transform .16s ease, box-shadow .16s ease, background .16s ease;
    }
    .btn2:hover{ transform: translateY(-1px); box-shadow: 0 12px 26px rgba(20,16,13,.10); }
    .btn2:active{ transform: translateY(0px) scale(.99); }

    footer{
      margin-top: 26px;
      text-align:center;
      color: rgba(30,25,22,.62);
      font-weight:700;
    }
  </style>
</head>

<body>
  <div class="bg"></div>
  <div class="stars" aria-hidden="true"></div>

  <div class="wrap">
    <!-- Teddy corner illustration -->
    <svg class="teddyCorner" viewBox="0 0 320 320" aria-hidden="true">
      <defs>
        <linearGradient id="fur" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0" stop-color="#C9A777"/>
          <stop offset="1" stop-color="#B88F5F"/>
        </linearGradient>
        <linearGradient id="fur2" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0" stop-color="#EAD7B9"/>
          <stop offset="1" stop-color="#D8C2A2"/>
        </linearGradient>
      </defs>

      <!-- head peeking from right -->
      <g transform="translate(92,34)">
        <circle cx="140" cy="132" r="92" fill="url(#fur)" opacity="0.92"/>
        <circle cx="86" cy="78" r="32" fill="url(#fur)" opacity="0.92"/>
        <circle cx="194" cy="78" r="32" fill="url(#fur)" opacity="0.92"/>

        <circle cx="140" cy="156" r="52" fill="url(#fur2)" opacity="0.95"/>

        <!-- eyes -->
        <circle cx="116" cy="132" r="6.6" fill="#1E1916" opacity="0.75"/>
        <circle cx="164" cy="132" r="6.6" fill="#1E1916" opacity="0.75"/>
        <!-- blush -->
        <ellipse cx="98" cy="154" rx="14" ry="9" fill="#F3C2CC" opacity="0.65"/>
        <ellipse cx="182" cy="154" rx="14" ry="9" fill="#F3C2CC" opacity="0.65"/>
        <!-- nose -->
        <path d="M140 146c10 0 18 6 18 14 0 10-12 16-18 16s-18-6-18-16c0-8 8-14 18-14z" fill="#1E1916" opacity="0.55"/>
        <path d="M132 170c6 8 18 8 24 0" stroke="#1E1916" stroke-width="4" stroke-linecap="round" opacity="0.35"/>
      </g>
    </svg>

    <header>
      <div class="kicker"><span class="kDot"></span> Invitaci√≥n</div>
      <h1>Cumple 2 de Anya Sof√≠a üß∏</h1>
      <p class="sub">Te invitamos a celebrar con nosotros un d√≠a muy especial.</p>

      <div class="metaLine" aria-label="Resumen">
        <span>üìÖ <b>21 Feb 2026</b></span>
        <span>üïê <b>1:00 pm</b></span>
        <span>‚è≥ <b><span id="daysLeft">‚Äî</span></b> d√≠as</span>
      </div>

      <div class="divider"></div>
    </header>

    <section class="sections" aria-label="Secciones">
      <!-- DETALLES -->
      <div>
        <h2 class="secTitle">Detalles</h2>

        <div class="list">
          <div class="li"><div class="ico">üìÖ</div><div><b>Fecha</b><br> S√°bado 21 de febrero de 2026</div></div>
          <div class="li"><div class="ico">üïê</div><div><b>Hora</b><br> 1:00 pm</div></div>
          <div class="li"><div class="ico">üìç</div><div>
            <b>Direcci√≥n</b><br>
            ‚ÄúResidencial Diligencias‚Äù Prolongaci√≥n 5 de Mayo #40 Casa 18, San Pedro M√°rtir, Tlalpan
            <div>
              <a class="mapInline" href="https://maps.app.goo.gl/DMSZ7EwkoQYT4Nep7" target="_blank" rel="noopener">
                üó∫Ô∏è Abrir ubicaci√≥n
              </a>
            </div>
          </div></div>
        </div>

        <div class="note">üëô Traer traje de ba√±o (puede cambiar)</div>
      </div>

      <!-- CONFIRMACI√ìN -->
      <div>
        <h2 class="secTitle">Confirmaci√≥n</h2>
        <p class="cta">Te pedimos confirmar asistencia usando el siguiente link.</p>

        <a class="btn"
           href="https://wa.me/5215513440269?text=Hola%2C%20soy%20____.%20Confirmo%3A%20__%20adultos%20y%20__%20ni%C3%B1os.%20"
           target="_blank" rel="noopener">
          ¬øVoy, o no voy?
        </a>
      </div>
    </section>

    <!-- GAME -->
    <section class="game" aria-label="Juego">
      <div class="gameHead">
        <h2 class="secTitle" style="margin:0;">Abrazo de Ositos</h2>
        <div class="hud">
          üß∏ Abrazos: <b id="score">0</b> ¬∑ ‚≠ê Racha: <b id="streak">0</b>
        </div>
      </div>

      <div class="canvasWrap">
        <canvas id="game" width="900" height="520" aria-label="Juego de abrazar ositos"></canvas>
      </div>

      <div class="gameActions">
        <button class="btn2" id="startBtn" type="button">Iniciar</button>
        <button class="btn2" id="resetBtn" type="button">Reiniciar</button>
      </div>
    </section>

    <footer>
      Hecho con üß∏ para Anya Sof√≠a ‚Äî Eli y Carlos
    </footer>
  </div>

  <script>
    // D√≠as restantes hacia 2026-02-21
    (function(){
      const eventDate = new Date(2026, 1, 21);
      const now = new Date();
      const start = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const end = new Date(eventDate.getFullYear(), eventDate.getMonth(), eventDate.getDate());
      const diffMs = end - start;
      const days = Math.max(0, Math.round(diffMs / (1000*60*60*24)));
      document.getElementById("daysLeft").textContent = String(days);
    })();

    // ===== Mini juego: "Abrazo de Ositos" (ni√±a mejorada + brazos extendidos) =====
    (function(){
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");

      const scoreEl = document.getElementById("score");
      const streakEl = document.getElementById("streak");
      const startBtn = document.getElementById("startBtn");
      const resetBtn = document.getElementById("resetBtn");

      const DPR = Math.min(2, window.devicePixelRatio || 1);

      function resizeCanvas(){
        const rect = canvas.getBoundingClientRect();
        const cssW = Math.max(320, rect.width);
        const cssH = Math.max(360, Math.round(cssW * 0.56));
        canvas.style.height = cssH + "px";
        canvas.width  = Math.floor(cssW * DPR);
        canvas.height = Math.floor(cssH * DPR);
        ctx.setTransform(DPR,0,0,DPR,0,0);
        placeGirlCenter();
      }
      setTimeout(resizeCanvas, 0);
      window.addEventListener("resize", resizeCanvas);

      const state = {
        running:false,
        score:0,
        streak:0,
        bears:[],
        lastSpawn:0,
        spawnEvery: 650,
        speed: 1.2
      };

      const girl = {
        x:0, y:0,
        w:96, h:118,
        targetX:0,
      };

      function placeGirlCenter(){
        const w = canvas.getBoundingClientRect().width;
        const h = canvas.getBoundingClientRect().height;
        girl.w = Math.max(86, Math.min(120, w * 0.16));
        girl.h = girl.w * 1.18;
        girl.x = (w - girl.w)/2;
        girl.y = h - girl.h - 16;
        girl.targetX = girl.x;
      }

      function reset(){
        state.running=false;
        state.score=0;
        state.streak=0;
        state.bears.length=0;
        state.lastSpawn=0;
        state.spawnEvery=650;
        state.speed=1.2;
        scoreEl.textContent = "0";
        streakEl.textContent = "0";
        placeGirlCenter();
        drawFrame();
      }

      function rand(min,max){ return Math.random()*(max-min)+min; }

      function spawnBear(){
        const w = canvas.getBoundingClientRect().width;
        const size = Math.max(26, Math.min(44, w * 0.055));
        state.bears.push({
          x: rand(12, w - size - 12),
          y: -size - 10,
          s: size,
          vy: rand(1.15, 2.25) + (state.speed * 0.35),
          wob: rand(0.9, 1.6),
          phase: rand(0, Math.PI*2),
        });
      }

      function hit(b){
        // hitbox ‚Äúabrazo‚Äù: un rect√°ngulo m√°s ancho que el cuerpo (porque brazos extendidos)
        const gx = girl.x, gy = girl.y, gw = girl.w, gh = girl.h;

        const hugW = gw * 1.55;                  // ancho del ‚Äúabrazo‚Äù
        const hugX = gx - (hugW - gw)/2;         // centrado
        const hugY = gy + gh*0.36;               // zona de brazos
        const hugH = gh*0.36;

        const bx = b.x, by = b.y, bs = b.s;

        return (bx + bs > hugX && bx < hugX + hugW && by + bs > hugY && by < hugY + hugH);
      }

      function roundRect(x, y, w, h, r, fill, stroke) {
        r = Math.min(r, Math.abs(w)/2, Math.abs(h)/2);
        ctx.beginPath();
        ctx.moveTo(x + r, y);
        ctx.arcTo(x + w, y, x + w, y + h, r);
        ctx.arcTo(x + w, y + h, x, y + h, r);
        ctx.arcTo(x, y + h, x, y, r);
        ctx.arcTo(x, y, x + w, y, r);
        ctx.closePath();
        if (fill) ctx.fill();
        if (stroke) ctx.stroke();
      }

      function drawBear(b){
        const x=b.x, y=b.y, s=b.s;
        const line = "rgba(30,25,22,.12)";

        // shadow
        ctx.fillStyle = "rgba(30,25,22,.10)";
        ctx.beginPath();
        ctx.ellipse(x + s*0.50, y + s*0.88, s*0.38, s*0.14, 0, 0, Math.PI*2);
        ctx.fill();

        // ears
        ctx.fillStyle = "rgba(242,231,221,.95)";
        ctx.strokeStyle = line;
        ctx.lineWidth = 1;
        ctx.beginPath(); ctx.ellipse(x + s*0.25, y + s*0.26, s*0.18, s*0.16, 0, 0, Math.PI*2); ctx.fill(); ctx.stroke();
        ctx.beginPath(); ctx.ellipse(x + s*0.75, y + s*0.26, s*0.18, s*0.16, 0, 0, Math.PI*2); ctx.fill(); ctx.stroke();

        // face
        ctx.beginPath();
        ctx.ellipse(x + s*0.50, y + s*0.55, s*0.40, s*0.36, 0, 0, Math.PI*2);
        ctx.fill(); ctx.stroke();

        // blush
        ctx.fillStyle = "rgba(243,194,204,.55)";
        ctx.beginPath(); ctx.ellipse(x + s*0.34, y + s*0.62, s*0.09, s*0.06, 0, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.ellipse(x + s*0.66, y + s*0.62, s*0.09, s*0.06, 0, 0, Math.PI*2); ctx.fill();

        // eyes
        ctx.fillStyle = "rgba(30,25,22,.55)";
        ctx.beginPath(); ctx.ellipse(x + s*0.40, y + s*0.53, s*0.035, s*0.05, 0, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.ellipse(x + s*0.60, y + s*0.53, s*0.035, s*0.05, 0, 0, Math.PI*2); ctx.fill();

        // snout
        ctx.fillStyle = "rgba(242,231,221,.82)";
        ctx.beginPath(); ctx.ellipse(x + s*0.50, y + s*0.64, s*0.16, s*0.12, 0, 0, Math.PI*2); ctx.fill(); ctx.stroke();

        // nose + smile
        ctx.fillStyle = "rgba(30,25,22,.55)";
        ctx.beginPath(); ctx.ellipse(x + s*0.50, y + s*0.62, s*0.04, s*0.03, 0, 0, Math.PI*2); ctx.fill();
        ctx.strokeStyle = "rgba(30,25,22,.30)";
        ctx.lineWidth = 2.5;
        ctx.beginPath();
        ctx.moveTo(x + s*0.50, y + s*0.66);
        ctx.quadraticCurveTo(x + s*0.46, y + s*0.70, x + s*0.42, y + s*0.69);
        ctx.moveTo(x + s*0.50, y + s*0.66);
        ctx.quadraticCurveTo(x + s*0.54, y + s*0.70, x + s*0.58, y + s*0.69);
        ctx.stroke();
      }

      function drawGirl(){
        const w = girl.w, h = girl.h;
        const x = girl.x, y = girl.y;

        // shadow
        ctx.fillStyle = "rgba(30,25,22,.10)";
        ctx.beginPath();
        ctx.ellipse(x + w*0.50, y + h*0.95, w*0.40, h*0.08, 0, 0, Math.PI*2);
        ctx.fill();

        // dress (soft gradient)
        const g = ctx.createLinearGradient(0, y+h*0.50, 0, y+h);
        g.addColorStop(0, "rgba(243,194,204,.95)");
        g.addColorStop(1, "rgba(211,227,255,.75)");
        ctx.fillStyle = g;
        roundRect(x + w*0.24, y + h*0.52, w*0.52, h*0.42, 24, true, false);

        // neck
        ctx.fillStyle = "rgba(242,231,221,.92)";
        roundRect(x + w*0.46, y + h*0.48, w*0.08, h*0.06, 10, true, false);

        // head
        ctx.fillStyle = "rgba(242,231,221,.96)";
        ctx.beginPath();
        ctx.ellipse(x + w*0.50, y + h*0.28, w*0.23, h*0.20, 0, 0, Math.PI*2);
        ctx.fill();

        // hair (better shape)
        ctx.fillStyle = "rgba(30,25,22,.20)";
        ctx.beginPath();
        ctx.ellipse(x + w*0.50, y + h*0.22, w*0.25, h*0.18, 0, Math.PI, Math.PI*2);
        ctx.fill();
        // side bangs
        ctx.beginPath();
        ctx.ellipse(x + w*0.40, y + h*0.27, w*0.10, h*0.08, 0.2, 0, Math.PI*2);
        ctx.fill();

        // eyes (tiny)
        ctx.fillStyle = "rgba(30,25,22,.55)";
        ctx.beginPath(); ctx.ellipse(x + w*0.46, y + h*0.28, w*0.02, h*0.025, 0, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.ellipse(x + w*0.54, y + h*0.28, w*0.02, h*0.025, 0, 0, Math.PI*2); ctx.fill();

        // blush
        ctx.fillStyle = "rgba(243,194,204,.55)";
        ctx.beginPath(); ctx.ellipse(x + w*0.43, y + h*0.31, w*0.03, h*0.02, 0, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.ellipse(x + w*0.57, y + h*0.31, w*0.03, h*0.02, 0, 0, Math.PI*2); ctx.fill();

        // smile
        ctx.strokeStyle = "rgba(30,25,22,.28)";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(x + w*0.50, y + h*0.31, w*0.04, 0.15*Math.PI, 0.85*Math.PI);
        ctx.stroke();

        // arms extended (HUG)
        // left arm
        ctx.fillStyle = "rgba(242,231,221,.95)";
        roundRect(x - w*0.34, y + h*0.58, w*0.48, h*0.12, 999, true, false);
        // right arm
        roundRect(x + w*0.86, y + h*0.58, w*0.48, h*0.12, 999, true, false);

        // hands
        ctx.beginPath(); ctx.ellipse(x + w*0.14, y + h*0.64, w*0.05, h*0.04, 0, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.ellipse(x + w*0.86, y + h*0.64, w*0.05, h*0.04, 0, 0, Math.PI*2); ctx.fill();

        // small bow
        ctx.fillStyle = "rgba(211,227,255,.92)";
        roundRect(x + w*0.58, y + h*0.10, w*0.16, h*0.09, 10, true, false);
        roundRect(x + w*0.67, y + h*0.10, w*0.16, h*0.09, 10, true, false);
      }

      function update(dt){
        const w = canvas.getBoundingClientRect().width;
        const h = canvas.getBoundingClientRect().height;

        girl.x += (girl.targetX - girl.x) * Math.min(1, dt * 0.012);
        girl.x = Math.max(8, Math.min(w - girl.w - 8, girl.x));
        girl.targetX = Math.max(8, Math.min(w - girl.w - 8, girl.targetX));

        state.lastSpawn += dt;
        if(state.lastSpawn >= state.spawnEvery){
          state.lastSpawn = 0;
          spawnBear();
          state.speed = Math.min(4.2, state.speed + 0.03);
          state.spawnEvery = Math.max(380, state.spawnEvery - 2);
        }

        const still = [];
        let missed = 0;

        for(const b of state.bears){
          b.phase += dt * 0.004;
          b.x += Math.sin(b.phase) * b.wob * 0.25;
          b.y += b.vy * (dt * 0.06);

          if(hit(b)){
            state.score += 1;
            state.streak += 1;
            scoreEl.textContent = String(state.score);
            streakEl.textContent = String(state.streak);
            continue;
          }

          if(b.y > h + 60){
            missed += 1;
            continue;
          }
          still.push(b);
        }

        if(missed > 0){
          state.streak = 0;
          streakEl.textContent = "0";
        }

        state.bears = still;
      }

      function drawFrame(){
        const w = canvas.getBoundingClientRect().width;
        const h = canvas.getBoundingClientRect().height;

        ctx.clearRect(0,0,w,h);

        // bears
        for(const b of state.bears) drawBear(b);
        // girl
        drawGirl();
      }

      let lastTs = 0;
      function loop(ts){
        if(!state.running){ drawFrame(); return; }
        const dt = Math.min(40, ts - lastTs || 16);
        lastTs = ts;
        update(dt);
        drawFrame();
        requestAnimationFrame(loop);
      }

      function setTargetFromClientX(clientX){
        const rect = canvas.getBoundingClientRect();
        const x = clientX - rect.left;
        girl.targetX = x - girl.w/2;
      }

      canvas.addEventListener("mousemove", (e)=> setTargetFromClientX(e.clientX));
      canvas.addEventListener("touchstart", (e)=>{ if(e.touches?.[0]) setTargetFromClientX(e.touches[0].clientX); }, {passive:true});
      canvas.addEventListener("touchmove", (e)=>{ if(e.touches?.[0]) setTargetFromClientX(e.touches[0].clientX); }, {passive:true});

      window.addEventListener("keydown", (e)=>{
        if(!state.running) return;
        const step = 28;
        if(e.key === "ArrowLeft") girl.targetX -= step;
        if(e.key === "ArrowRight") girl.targetX += step;
      });

      startBtn.addEventListener("click", ()=>{
        if(!state.running){
          state.running = true;
          lastTs = 0;
          requestAnimationFrame(loop);
        }
      });

      resetBtn.addEventListener("click", ()=> reset());

      placeGirlCenter();
      reset();
      requestAnimationFrame(loop);
    })();
  </script>
</body>
</html>
